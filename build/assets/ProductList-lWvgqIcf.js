import{aA as $,ak as M,f as L,j as e,X as Q,R as z,r as y,V as W}from"./index-B5IrYwSf.js";import{u as X,C as Z,a as _,D as H,A as J}from"./useDebounce-CtS5788L.js";import{B as F,u as K,C as f,I as U,F as Y,a as T}from"./index.esm-CCO8k5GL.js";import{e as ee,g as ae,h as te,m as se,A as re}from"./index-DzIjJXQ9.js";import{a as ne,F as le}from"./index-Diu7EEv5.js";import{S as N,c as oe,O as ce}from"./Select-BaPAiwbL.js";import{D as ie}from"./Drawer-cn7TLeWU.js";import{C as k}from"./index-CIt6kdqh.js";import{B}from"./Badge-DStSZEmW.js";import{N as R,a as O}from"./NumericInput-B-TYsbtv.js";import{t as de,z as x}from"./index-CzVxQRl_.js";import{c as P}from"./Dialog-uXgwdOg_.js";import{L as ue,C as me}from"./Circle-BBway6_x.js";import{C as he}from"./ConfirmDialog-SACwPh4o.js";import"./Card-BwF7YU63.js";import"./useControllableState-DqCAkSU0.js";import"./CloseButton-Cfj2d_0a.js";import"./Pagination-N3uZXzPk.js";import"./index-DPUiuvHR.js";import"./debounce-B0zjTqoc.js";import"./toString-DGAcNTrc.js";import"./useMergeRef-CbC_Qfe6.js";import"./floating-ui.dom-4meoaf82.js";const xe=n=>{const{className:s,customInfo:o,customColorClass:i,gapDegree:c=0,gapPosition:u=$.TOP,percent:d=0,ref:m,showInfo:a=!0,size:l=M.MD,strokeLinecap:p="round",strokeWidth:g=6,width:j=120,variant:h="line"}=n,b=()=>a?e.jsx("span",{className:`progress-info heading-text font-bold ${h}`,children:o||`${d}%`}):null,S=i||(h==="line"?"bg-primary":"text-primary"),C=L("progress",s,h==="circle"?"circle":"line"),w=()=>{const D=b();let v;return h==="line"&&(v=e.jsx(ue,{percent:d,size:l,strokeColor:S,...n,children:D})),h==="circle"&&(v=e.jsx(me,{gapDegree:c,gapPosition:u,percent:d,strokeColor:S,strokeLinecap:p,strokeWidth:g,width:j,...n,children:D})),v};return e.jsx("div",{ref:m,className:C,children:w()})},pe={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ge={minAmount:0,maxAmount:5e3,productStatus:"published",productType:["Bags","Cloths","Devices","Shoes","Watches"]},fe={tableData:pe,filterData:ge,selectedProduct:[]},je=Q(n=>({...fe,setFilterData:s=>n(()=>({filterData:s})),setTableData:s=>n(()=>({tableData:s})),setSelectedProduct:(s,o)=>n(i=>{const c=i.selectedProduct;return s?{selectedProduct:[...c,o]}:c.some(u=>o.id===u.id)?{selectedProduct:c.filter(u=>u.id!==o.id)}:{selectedProduct:c}}),setSelectAllProduct:s=>n(()=>({selectedProduct:s}))})),I=()=>{const{tableData:n,filterData:s,setTableData:o,setFilterData:i,selectedProduct:c,setSelectedProduct:u,setSelectAllProduct:d}=je(h=>h),{data:m,error:a,isLoading:l,mutate:p}=X(["/api/products",{...n,...s}],([h,b])=>ne(b),{revalidateOnFocus:!1}),g=(m==null?void 0:m.list)||[],j=(m==null?void 0:m.total)||0;return{error:a,isLoading:l,tableData:n,filterData:s,mutate:p,productList:g,productListTotal:j,setTableData:o,selectedProduct:c,setSelectedProduct:u,setSelectAllProduct:d,setFilterData:i}},be=()=>{z();const{productList:n}=I();return e.jsx("div",{className:"flex flex-col md:flex-row gap-3",children:e.jsx(Z,{filename:"product-list.csv",data:n,children:e.jsx(F,{icon:e.jsx(ee,{className:"text-xl"}),children:"Export"})})})},Ce=n=>{const{onInputChange:s}=n;function o(a){s==null||s(a)}const i=_(o,500),{handleSubmit:c,formState:{errors:u},control:d}=K({defaultValues:{country:"",channelName:"",isActive:!0}}),m=a=>{i(a.target.value)};return e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(f,{name:"country",control:d,render:({field:a})=>e.jsx(N,{size:"sm",placeholder:"Select Area",options:[{label:"All Island",value:"All Island"},{label:"Central",value:"Central"},{label:"Gampaha",value:"Gampaha"}],value:a.value,onChange:l=>a.onChange(l)}),rules:{validate:{required:a=>{if(!a)return"Required"}}}}),e.jsx("div",{children:e.jsx(f,{name:"country",control:d,render:({field:a})=>e.jsx(N,{size:"sm",placeholder:"Select Agency",options:[{label:"All Island",value:"All Island"},{label:"Gampaha",value:"Gampaha"}],value:a.value,onChange:l=>a.onChange(l)}),rules:{validate:{required:a=>{if(!a)return"Required"}}}})}),e.jsx("div",{children:e.jsx(f,{name:"country",control:d,render:({field:a})=>e.jsx(N,{size:"sm",placeholder:"Select Range",options:[{label:"C",value:"C"},{label:"D",value:"D"}],value:a.value,onChange:l=>a.onChange(l)}),rules:{validate:{required:a=>{if(!a)return"Required"}}}})}),e.jsx("div",{children:e.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:()=>s(""),children:"Search"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"search",children:"Search"}),e.jsx(U,{id:"search",placeholder:"Search",suffix:e.jsx(ae,{className:"text-lg"}),onChange:m})]})]})})},{Control:ve}=oe,q=[{value:"published",label:"Published",className:"bg-emerald-500"},{value:"inactive",label:"Inactive",className:"bg-red-500"},{value:"scheduled",label:"Scheduled",className:"bg-amber-500"},{value:"draft",label:"Draft",className:"bg-gray-400"}],Se=["Soya","Araya","Devan 1","Nenaposha","Pasta"],De=n=>e.jsx(ce,{...n,customLabel:(s,o)=>e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(B,{className:s.className}),e.jsx("span",{className:"ml-2 rtl:mr-2",children:o})]})}),ye=({children:n,...s})=>{const o=s.getValue()[0];return e.jsxs(ve,{...s,children:[o&&e.jsx(B,{className:L("ml-4",o.className)}),n]})},Ne=x.object({minAmount:x.union([x.string(),x.number()]),maxAmount:x.union([x.string(),x.number()]),productStatus:x.string(),productType:x.array(x.string())}),Pe=()=>{const[n,s]=y.useState(!1),{filterData:o,setFilterData:i}=I(),{handleSubmit:c,control:u,getValues:d}=K({defaultValues:o,resolver:de(Ne)}),m=a=>{i(a),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{icon:e.jsx(te,{}),onClick:()=>s(!0),children:"Filter"}),e.jsx(ie,{title:"Filter",isOpen:n,onClose:()=>s(!1),onRequestClose:()=>s(!1),children:e.jsxs(Y,{className:"h-full",containerClassName:"flex flex-col justify-between h-full",onSubmit:c(m),children:[e.jsxs("div",{children:[e.jsx(T,{label:"Product price",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{name:"minAmount",control:u,render:({field:a})=>e.jsx(R,{thousandSeparator:!0,type:"text",inputPrefix:"$",autoComplete:"off",placeholder:"0.00",value:a.value,max:d("maxAmount"),isAllowed:l=>{const{floatValue:p}=l;return(p||0)<=d("maxAmount")},onChange:l=>a.onChange(l.target.value)})}),e.jsx("span",{children:e.jsx(se,{})}),e.jsx(f,{name:"maxAmount",control:u,render:({field:a})=>e.jsx(R,{thousandSeparator:!0,type:"text",inputPrefix:"$",autoComplete:"off",placeholder:"0.00",value:a.value,onChange:a.onChange})})]})}),e.jsx(T,{label:"Product status",children:e.jsx(f,{name:"productStatus",control:u,render:({field:a})=>e.jsx(N,{options:q,...a,value:q.filter(l=>l.value===a.value),components:{Option:De,Control:ye},onChange:l=>a.onChange(l==null?void 0:l.value)})})}),e.jsx(T,{label:"Product type",children:e.jsx("div",{className:"mt-4",children:e.jsx(f,{name:"productType",control:u,render:({field:a})=>e.jsx(k.Group,{vertical:!0,className:"flex",...a,children:Se.map((l,p)=>e.jsx(k,{name:a.name,value:l,className:"justify-between flex-row-reverse heading-text",children:l},l+p))})})})})]}),e.jsx(F,{variant:"solid",type:"submit",children:"Query"})]})})]})},Ie=()=>{const{tableData:n,setTableData:s}=I(),o=i=>{const c=P(n);c.query=i,c.pageIndex=1,typeof i=="string"&&i.length>1&&s(c),typeof i=="string"&&i.length===0&&s(c)};return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx(Ce,{onInputChange:o}),e.jsx(Pe,{})]})},we=({row:n})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{shape:"round",size:60,...n.img?{src:n.img}:{icon:e.jsx(le,{})}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold heading-text mb-1",children:n.name}),e.jsxs("span",{children:["ID: ",n.productCode]})]})]}),Ae=()=>{z();const[n,s]=y.useState(!1),[o,i]=y.useState(""),c=()=>{s(!1)},u=()=>{const r=d.filter(t=>o!==t.id);g([]),b({list:r,total:m-h.length},!1),s(!1),i("")},{productList:d,productListTotal:m,tableData:a,isLoading:l,setTableData:p,setSelectAllProduct:g,setSelectedProduct:j,selectedProduct:h,mutate:b}=I(),S=y.useMemo(()=>[{header:"Product",accessorKey:"name",cell:r=>{const t=r.row.original;return e.jsx(we,{row:t})}},{header:"Price",accessorKey:"price",cell:r=>{const{price:t}=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:e.jsx(O,{fixedDecimalScale:!0,prefix:"$",displayType:"text",value:t,decimalScale:2,thousandSeparator:!0})})}},{header:"Quantity",accessorKey:"stock",cell:r=>{const t=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:t.stock})}},{header:"Damaged",accessorKey:"Damaged",cell:r=>{const t=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:t.Damaged})}},{header:"Required Qty",accessorKey:"Rqty",cell:r=>{const t=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:t.Rqty})}},{header:"Invoice Actual",accessorKey:"Iactual",cell:r=>{const t=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:t.Iactual})}},{header:"Company Invoice Accepted",accessorKey:"CIAccepted",cell:r=>{const t=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:t.CIAccepted})}},{header:"Company Invoice Pending",accessorKey:"CIPeding",cell:r=>{const t=r.row.original;return e.jsx("span",{className:"font-bold heading-text",children:t.CIPeding})}},{header:"Sales",accessorKey:"status",cell:r=>{const{salesPercentage:t,sales:A}=r.row.original;return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:"flex gap-1",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(O,{displayType:"text",value:A,thousandSeparator:!0})}),e.jsx("span",{children:"Sales"})]}),e.jsx(xe,{percent:t,showInfo:!1,customColorClass:L("bg-error",t>40&&"bg-warning",t>70&&"bg-success")})]})}}],[]),C=r=>{p(r),h.length>0&&g([])},w=r=>{const t=P(a);t.pageIndex=r,C(t)},D=r=>{const t=P(a);t.pageSize=Number(r),t.pageIndex=1,C(t)},v=r=>{const t=P(a);t.sort=r,C(t)},V=(r,t)=>{j(r,t)},G=(r,t)=>{if(r){const A=t.map(E=>E.original);g(A)}else g([])};return e.jsxs(e.Fragment,{children:[e.jsx(H,{selectable:!0,columns:S,data:d,noData:!l&&d.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:l,pagingData:{total:m,pageIndex:a.pageIndex,pageSize:a.pageSize},checkboxChecked:r=>h.some(t=>t.id===r.id),onPaginationChange:w,onSelectChange:D,onSort:v,onCheckBoxChange:V,onIndeterminateCheckBoxChange:G}),e.jsx(he,{isOpen:n,type:"danger",title:"Remove products",onClose:c,onRequestClose:c,onCancel:c,onConfirm:u,children:e.jsxs("p",{children:[" ","Are you sure you want to remove this product? This action can't be undo."," "]})})]})},Ye=()=>e.jsx(e.Fragment,{children:e.jsx(W,{children:e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Products"}),e.jsx(be,{})]}),e.jsx(Ie,{}),e.jsx(Ae,{})]})})})});export{Ye as default};
