import{r as o,j as a}from"./index-B5IrYwSf.js";import{g as C,C as G}from"./CloseButton-Cfj2d_0a.js";import{c as H}from"./Dialog-uXgwdOg_.js";import{F as K}from"./FileItem-CyU1Hyvm.js";import{B as Q}from"./index.esm-CCO8k5GL.js";import{N as V}from"./Notification-nsktbxlj.js";import{t as W}from"./toast-Bf3WYsML.js";const k=i=>Object.keys(i).map(c=>i[c]),re=i=>{const{accept:c,beforeUpload:N,disabled:l=!1,draggable:t=!1,fileList:f=[],fileListClass:D,fileItemClass:O,multiple:L,onChange:u,onFileRemove:m,ref:U,showList:S=!0,tip:E,uploadLimit:p,children:g,className:I,...j}=i,v=o.useRef(null),[n,h]=o.useState(f),[w,b]=o.useState(!1);o.useEffect(()=>{JSON.stringify(n)!==JSON.stringify(f)&&h(f)},[JSON.stringify(f)]);const x=(s="")=>{W.push(a.jsx(V,{type:"danger",duration:2e3,children:s||"Upload Failed!"}),{placement:"top-center"})},y=(s,e)=>{if(s)for(const r of s)e.push(r);return e},B=s=>{let e=H(n);return typeof p=="number"&&p!==0&&Object.keys(e).length>=p?(p===1&&(e.shift(),e=y(s,e)),k({...e})):(e=y(s,e),k({...e}))},J=s=>{const{files:e}=s.target;let r=!0;if(N){if(r=N(e,n),r===!1){x();return}if(typeof r=="string"&&r.length>0){x(r);return}}if(r){const d=B(e);h(d),u==null||u(d,n)}},P=s=>{const e=n.filter((r,d)=>d!==s);h(e),m==null||m(e)},T=s=>{var e;l||(e=v.current)==null||e.click(),s.stopPropagation()},A=()=>!t&&!g?a.jsx(Q,{disabled:l,onClick:s=>s.preventDefault(),children:"Upload"}):t&&!g?a.jsx("span",{children:"Choose a file or drag and drop here"}):g,M=o.useCallback(()=>{t&&b(!1)},[t]),R=o.useCallback(()=>{t&&!l&&b(!0)},[t,l]),_=o.useCallback(()=>{t&&b(!1)},[t]),$={onDragLeave:M,onDragOver:R,onDrop:_},F="border-primary",q=C("upload",t&&"upload-draggable",t&&!l&&`hover:${F}`,t&&l&&"disabled",w&&F,I),z=C("upload-input",t&&"draggable");return a.jsxs(a.Fragment,{children:[a.jsxs("div",{ref:U,className:q,...t?$:{onClick:T},...j,children:[a.jsx("input",{ref:v,className:z,type:"file",disabled:l,multiple:L,accept:c,title:"",value:"",onChange:J,...j}),A()]}),E,S&&a.jsx("div",{className:C("upload-file-list",D),children:n.map((s,e)=>a.jsx(K,{file:s,className:O,children:a.jsx(G,{className:"upload-file-remove",onClick:()=>P(e)})},s.name+e))})]})},le=i=>new Promise(c=>setTimeout(c,i));export{re as U,le as s};
